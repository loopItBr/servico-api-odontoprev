-- Criação da tabela TB_CONTROLE_SYNC_ODONTOPREV_BENEF
CREATE TABLE TASY.TB_CONTROLE_SYNC_ODONTOPREV_BENEF (
    ID NUMBER GENERATED BY DEFAULT AS IDENTITY,
    CODIGO_EMPRESA VARCHAR2(6) NOT NULL,
    CODIGO_BENEFICIARIO VARCHAR2(15) NOT NULL,
    TIPO_LOG VARCHAR2(1) NOT NULL,
    TIPO_OPERACAO VARCHAR2(10) NOT NULL,
    ENDPOINT_DESTINO VARCHAR2(200),
    DADOS_JSON CLOB,
    STATUS_SYNC VARCHAR2(20) NOT NULL DEFAULT 'PENDING',
    TENTATIVAS NUMBER NOT NULL DEFAULT 0,
    MAX_TENTATIVAS NUMBER NOT NULL DEFAULT 3,
    DATA_CRIACAO TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
    DATA_ULTIMA_TENTATIVA TIMESTAMP,
    DATA_SUCESSO TIMESTAMP,
    ERRO_MENSAGEM CLOB,
    RESPONSE_API CLOB,
    CONSTRAINT PK_CONTROLE_SYNC_BENEF PRIMARY KEY (ID)
);

-- Índices
CREATE INDEX IDX_CONTROLE_SYNC_STATUS ON TASY.TB_CONTROLE_SYNC_ODONTOPREV_BENEF (STATUS_SYNC);
CREATE INDEX IDX_CONTROLE_SYNC_EMPRESA ON TASY.TB_CONTROLE_SYNC_ODONTOPREV_BENEF (CODIGO_EMPRESA);
CREATE INDEX IDX_CONTROLE_SYNC_BENEFICIARIO ON TASY.TB_CONTROLE_SYNC_ODONTOPREV_BENEF (CODIGO_BENEFICIARIO);
CREATE INDEX IDX_CONTROLE_SYNC_DATA_CRIACAO ON TASY.TB_CONTROLE_SYNC_ODONTOPREV_BENEF (DATA_CRIACAO);
CREATE INDEX IDX_CONTROLE_SYNC_TIPO_OPERACAO ON TASY.TB_CONTROLE_SYNC_ODONTOPREV_BENEF (TIPO_OPERACAO);
